<!doctype html><html lang=en><head><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1" name=viewport><title>CLI text editing with ed</title><link href=https://learnbyexample.github.io/atom.xml rel=alternate title=RSS type=application/atom+xml><script src=https://cdnjs.cloudflare.com/ajax/libs/slideout/1.0.1/slideout.min.js></script><link href=https://learnbyexample.github.io/site.css rel=stylesheet><meta content="CLI text editing with ed" property=og:title><meta content=website property=og:type><meta content="Examples and resource links for the ed command." property=og:description><meta content=https://learnbyexample.github.io/cli-text-editing-with-ed/ property=og:url><meta content=@learn_byexample property=twitter:site><link href=https://learnbyexample.github.io/favicon.svg rel=icon><link rel="shortcut icon" href=https://learnbyexample.github.io/favicon.png><body><div class=container><div class=mobile-navbar id=mobile-navbar><div class=mobile-header-logo><a class=logo href=/>learnbyexample</a></div><div class="mobile-navbar-icon icon-out"><span></span><span></span><span></span></div></div><nav class="mobile-menu slideout-menu slideout-menu-left" id=mobile-menu><ul class=mobile-menu-list><li class=mobile-menu-item><a href=https://learnbyexample.github.io/books> Books </a><li class=mobile-menu-item><a href=https://learnbyexample.github.io/mini> Mini </a><li class=mobile-menu-item><a href=https://learnbyexample.github.io/tips> Tips </a><li class=mobile-menu-item><a href=https://learnbyexample.github.io/tags> Tags </a><li class=mobile-menu-item><a href=https://learnbyexample.github.io/about> About </a></ul></nav><header id=header><div class=logo><a href=https://learnbyexample.github.io>learnbyexample</a></div><nav class=menu><ul><li><a href=https://learnbyexample.github.io/books> Books </a><li><a href=https://learnbyexample.github.io/mini> Mini </a><li><a href=https://learnbyexample.github.io/tips> Tips </a><li><a href=https://learnbyexample.github.io/tags> Tags </a><li><a href=https://learnbyexample.github.io/about> About </a></ul></nav></header><main><div class=content id=mobile-panel><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a class=toc-link href=https://learnbyexample.github.io/mini/cli-text-editing-with-ed/#moving-lines>Moving lines</a><li><a class=toc-link href=https://learnbyexample.github.io/mini/cli-text-editing-with-ed/#negative-addressing>Negative addressing</a><li><a class=toc-link href=https://learnbyexample.github.io/mini/cli-text-editing-with-ed/#resource-links>Resource links</a></ul></nav></div></div><article class=post><header class=post__header><h1 class=post__title><a href=https://learnbyexample.github.io/mini/cli-text-editing-with-ed/>CLI text editing with ed</a></h1><div class=post__meta><span class=post__time>2023-10-17</span></div></header><div class=post-content><p>I'm finally writing a post on the <code>ed</code> command. And I'm keeping it short so that I'll actually publish the post. The examples presented below will be easier to understand for those already familiar with Vim and <code>sed</code>. See the links at the end for learning resources.<p>Although I'm interested in getting to know <code>ed</code> better, I don't really find myself in situations where it'd help me. But, I have used it a few times to answer questions on stackoverflow.<h2 id=moving-lines>Moving lines</h2><p>Consider this sample input file:<pre class=language-ruby data-lang=ruby style=background-color:#f5f5f5;color:#1f1f1f;><code class=language-ruby data-lang=ruby><span>$ cat ip.txt
</span><span>apple
</span><span>banana
</span><span>cherry
</span><span>fig
</span><span>mango
</span><span>pineapple
</span></code></pre><p>Suppose, you want to move the third line to the top. If you are using Vim, you can execute <code>:3m0</code> where <code>3</code> is the input address, <code>m</code> is the <em>move</em> command and <code>0</code> is the target address. To do the same with <code>ed</code>:<pre class=language-ruby data-lang=ruby style=background-color:#f5f5f5;color:#1f1f1f;><code class=language-ruby data-lang=ruby><span>$ </span><span style=color:#b39f04;>printf </span><span style=color:#d07711;>'3m0\nwq\n' </span><span style=color:#72ab00;>|</span><span> ed </span><span style=color:#72ab00;>-</span><span>s ip.txt </span><span style=color:#72ab00;>-
</span><span>
</span><span>$ cat ip.txt
</span><span>cherry
</span><span>apple
</span><span>banana
</span><span>fig
</span><span>mango
</span><span>pineapple
</span></code></pre><p>The <code>3m0</code> part in the above <code>ed</code> command is identical to the Vim solution. After that, another command <code>wq</code> (write and quit) is issued to save the changes (again, Vim users would be familiar with this combination). The <code>-s</code> option suppresses diagnostics and other details. <code>-</code> is used to indicate that the <code>ed</code> script is passed via stdin.<p>You can also move lines based on a regexp match. Here's an example:<pre class=language-ruby data-lang=ruby style=background-color:#f5f5f5;color:#1f1f1f;><code class=language-ruby data-lang=ruby><span style=color:#7f8989;># move the first matching line containing 'an' to the top of the file
</span><span>$ </span><span style=color:#b39f04;>printf </span><span style=color:#d07711;>'/an/m0\nwq\n' </span><span style=color:#72ab00;>|</span><span> ed </span><span style=color:#72ab00;>-</span><span>s ip.txt </span><span style=color:#72ab00;>-
</span><span>
</span><span>$ cat ip.txt
</span><span>banana
</span><span>cherry
</span><span>apple
</span><span>fig
</span><span>mango
</span><span>pineapple
</span></code></pre><p>If you want to move all the matching lines, you can use the <code>g</code> command (same as Vim). Note that the first matching line will be moved first, then the next matching line and so on. So the order will be reversed after the move.<pre class=language-ruby data-lang=ruby style=background-color:#f5f5f5;color:#1f1f1f;><code class=language-ruby data-lang=ruby><span>$ </span><span style=color:#b39f04;>printf </span><span style=color:#d07711;>'g/app/m0\nwq\n' </span><span style=color:#72ab00;>|</span><span> ed </span><span style=color:#72ab00;>-</span><span>s ip.txt </span><span style=color:#72ab00;>-
</span><span>
</span><span>$ cat ip.txt
</span><span>pineapple
</span><span>apple
</span><span>banana
</span><span>cherry
</span><span>fig
</span><span>mango
</span></code></pre><p>Here's the <a href=https://stackoverflow.com/q/67031062/4082052>stackoverflow link</a> that inspired the above examples. See <a href=https://stackoverflow.com/a/75222984/4082052>this stackoverflow answer</a> for more examples of moving lines. See <a href=https://stackoverflow.com/a/48840851/4082052>this one</a> to learn how to copy a particular line to the end of the file.<h2 id=negative-addressing>Negative addressing</h2><p>There are plenty of <a href=https://learnbyexample.github.io/learn_gnused/selective-editing.html>addressing features</a> provided by the <code>GNU sed</code> command, but negative addressing isn't one. Here's an example of deleting the last but second line using <code>ed</code>:<pre class=language-ruby data-lang=ruby style=background-color:#f5f5f5;color:#1f1f1f;><code class=language-ruby data-lang=ruby><span>$ cat colors.txt
</span><span>red
</span><span>green
</span><span>blue
</span><span>yellow
</span><span>black
</span><span>
</span><span>$ </span><span style=color:#b39f04;>printf </span><span style=color:#d07711;>'$-2d\nwq\n' </span><span style=color:#72ab00;>|</span><span> ed </span><span style=color:#72ab00;>-</span><span>s colors.txt </span><span style=color:#72ab00;>-
</span><span>$ cat colors.txt
</span><span>red
</span><span>green
</span><span>yellow
</span><span>black
</span></code></pre><h2 id=resource-links>Resource links</h2><ul><li><a href=https://blog.sanctum.geek.nz/actually-using-ed/>Actually using ed</a><li><a href=https://raymii.org/s/tutorials/ed_cheatsheet.html>ed cheatsheet</a><li><a href=https://jvns.ca/blog/2018/05/11/batch-editing-files-with-ed/>Batch editing files with ed</a><li><a href=https://en.wikipedia.org/wiki/Ed_(text_editor)>wikipedia entry for the ed command</a></ul></div><div class=post-footer><div class=post-tags><a href=https://learnbyexample.github.io/tags/linux/>#linux</a><a href=https://learnbyexample.github.io/tags/command-line/>#command-line</a><a href=https://learnbyexample.github.io/tags/ed/>#ed</a></div><hr color=#e6e6e6><div class=post-nav><p><a class=next href=https://learnbyexample.github.io/mini/cli-computing-sales/>Computing from the Command Line: sales report â†’</a><br></div><hr color=#e6e6e6><p>ðŸ“° Use <a href=https://learnbyexample.github.io/atom.xml>this link</a> for the Atom feed. <br> âœ… Follow me on <a href=https://twitter.com/learn_byexample>Twitter</a>, <a href=https://github.com/learnbyexample>GitHub</a> and <a href=https://www.youtube.com/c/learnbyexample42>Youtube</a> for interesting tech nuggets. <br> ðŸ“§ Subscribe to <a href=https://learnbyexample.gumroad.com/l/learnbyexample-weekly>learnbyexample weekly</a> for programming resources, tips, tools, free ebooks and more (free newsletter, delivered every Friday).<hr color=#e6e6e6></div></article></div></main></div><script src=https://learnbyexample.github.io/even.js></script>